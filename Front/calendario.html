<!DOCTYPE html>
<html lang="pt-br">

<head>
  <!-- Metadados cr√≠ticos -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta name="color-scheme" content="light dark">
  <meta name="description" content="Lista de calend√°rio">
  <title>Calend√°rio</title>

  <!-- Manifesto -->
  <link rel="manifest" href="./manifest.json">

  <!-- Conex√µes antecipadas para fontes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Carregamento da fonte -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@400;600&display=swap" rel="stylesheet">

  <!-- Favicon (ajustado para SVG) -->
  <link rel="icon" href="./static/imagens/icones/calendario-select.svg" type="image/svg+xml">

  <!-- Pr√©-carregamento e carregamento n√£o bloqueante do CSS -->
  <link rel="stylesheet" href="./static/css/style.css">

  <script>
    (function () {
      const theme = localStorage.getItem("theme");
      if (theme === "light-mode") {
        document.documentElement.classList.add("light-mode");
      }
    })();
  </script>

  <!-- Estilos customizados para o calend√°rio, modal e responsividade -->
  <style>
    /* Container Geral */
    .container-solo-template {
      display: grid;
      box-sizing: border-box;
      overflow-x: hidden;
      background: var(--container-bg);
      box-shadow: var(--sombra-moderada);
      border-radius: 25px;
      grid-template-columns: 1fr;
      grid-template-rows: auto 1fr;
      grid-template-areas: "container-solo-template-content";
      scroll-behavior: smooth;
    }

    .container-solo-template-content {
      grid-area: container-solo-template-content;
      padding: 0;
      border-radius: 25px;
      scroll-behavior: smooth;
    }

    /* RESPONSIVO (at√© 900px) */
    @media only screen and (max-width: 900px) {
      .container-solo-template {
        background: var(--bg-principal);
        border-radius: 25px;
        box-shadow: none;
        box-sizing: border-box;
        overflow-x: hidden;
      }

      .container-solo-template-content {
        border-radius: 25px;
        background: var(--container-bg);
        overflow: hidden;
      }

      .container-solo-template::-webkit-scrollbar {
        display: none;
      }
    }

    /* Container do Calend√°rio */
    #calendar {
      width: 100%;
      margin: 0 auto;
      background: var(--container-bg);
      box-shadow: var(--sombra-leve);
      border-radius: 25px;
      border: 1px solid var(--borda);
      box-sizing: border-box;
      height: calc(var(--vh, 1vh) * 100 - 5rem) !important;
    }

    /* Removendo bordas extras na grade interna */
    .fc-scrollgrid,
    .fc-scrollgrid table,
    .fc-theme-standard td:first-child {
      border: none !important;
      border-collapse: collapse;
    }

    .fc-theme-standard th {
      border-collapse: collapse;
    }

    /* Remove a borda direita do √∫ltimo cabe√ßalho da linha (√∫ltimo th) */
    .fc-scrollgrid thead tr th:last-child {
      border-right: none !important;
    }

    /* Remove a borda inferior extra do cabe√ßalho da grade */
    .fc-scrollgrid-section-header {
      border-bottom: none !important;
    }

    /* Remove a borda esquerda do primeiro th, se necess√°rio */
    .fc-scrollgrid thead tr th:first-child {
      border-left: none !important;
    }

    /* Cabe√ßalho e Barra de Ferramentas do FullCalendar */
    .fc-header-toolbar {
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-sizing: border-box;
    }

    .fc .fc-toolbar.fc-header-toolbar {
      margin-bottom: 0;
    }

    .fc-toolbar-title {
      font-size: var(--font-xl) !important;
      color: var(--txt-titulo) !important;
      line-height: var(--line-height) !important;
    }

    /* Bot√µes da Toolbar */
    .fc-button {
      background-color: var(--cor-primaria-2) !important;
      border-color: var(--container-bg) !important;
      border: none;
      border-radius: 4px;
      color: var(--txt-titulo) !important;
      font-weight: 600;
      padding: 8px 12px;
      margin: 0 2px;
      transition: background-color 0.3s;
      font-size: var(--font-md) !important;
      line-height: var(--line-height) !important;
    }

    .fc-button:hover {
      background-color: var(--cor-primaria-1) !important;
    }

    .fc-button:focus {
      outline: none !important;
      box-shadow: none !important;
    }

    .fc-button:disabled {
      background-color: var(--divisor);
      cursor: not-allowed;
    }

    /* Estilo para o bot√£o ativo (visualiza√ß√£o ativa) */
    .fc-button.fc-button-active {
      background-color: var(--cor-primaria-3) !important;
      border-color: var(--cor-primaria-3) !important;
    }

    /* Cabe√ßalho das Colunas (Dias da Semana) */
    .fc-col-header-cell {
      border-bottom: 2px solid var(--divisor);
      background-color: var(--card-bg);
      color: var(--txt-titulo);
      font-weight: bold;
      text-align: center;
      padding: 10px 0;
      font-size: var(--font-sm);
      line-height: var(--line-height);
    }

    /* Estilo dos Dias do Calend√°rio (Visualiza√ß√£o de M√™s) */
    .fc-daygrid-day,
    .fc-daygrid-day-frame,
    .fc-daygrid-day-cushion {
      border: none !important;
      border-left: 1px solid var(--divisor) !important;
      border-top: 1px solid var(--divisor) !important;
    }

    /* Centraliza os N√∫meros dos Dias */
    .fc-daygrid-day-top {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Oculta o Ponto Indicador dos Eventos */
    .fc-daygrid-event-dot {
      display: none;
    }

    /* Estilo dos Eventos */
    .fc-event {
      color: var(--txt-conteudo-card);
      font-size: var(--font-sm);
      padding: 2px 4px;
      border-radius: 4px;
      line-height: var(--line-height);
    }

    .fc-event:hover {
      background: var(--cor-primaria-2);
      color: var(--txt-titulo);
    }

    /* Garante que o T√≠tulo do Evento n√£o Quebre a Linha */
    .fc-event-title {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Linhas Divis√≥rias nas Visualiza√ß√µes de Semana e Dia */
    .fc-timegrid-slot,
    .fc-timegrid-slot-lane,
    .fc-timegrid-divider,
    .fc-timegrid-col {
      border-color: var(--divisor) !important;
    }

    /* Modal de Detalhes */
    #eventDetailModal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: var(--bg-overlay);
      transition: opacity 0.3s ease;
    }

    .modal-detail-content {
      background-color: var(--modal-bg);
      margin: 10% auto;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      position: relative;
      border: 2px solid var(--modal-borda);
      color: var(--modal-conteudo);
    }

    .modal-detail-content h2 {
      margin-top: 0;
      font-size: var(--font-xl);
      color: var(--modal-titulo);
      line-height: var(--line-height);
    }

    .modal-detail-content p {
      margin: 10px 0;
      font-size: var(--font-md);
      color: var(--modal-conteudo);
      line-height: var(--line-height);
    }

    .modal-detail-content img {
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }

    /* Bot√£o de Fechar o Modal */
    .close-modal {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: var(--font-xl);
      cursor: pointer;
      color: var(--cor-primaria-2);
    }

    .close-modal:hover {
      color: var(--cor-primaria-1);
    }

    /* Modal de Lista de Eventos do Dia */
    #dayEventsModal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: var(--bg-overlay);
      transition: opacity 0.3s ease;
    }

    .modal-day-events-content {
      background-color: var(--modal-bg);
      margin: 10% auto;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      position: relative;
      border: 2px solid var(--modal-borda);
      color: var(--modal-conteudo);
    }

    .modal-day-events-content h2 {
      margin-top: 0;
      font-size: var(--font-xl);
      color: var(--modal-titulo);
      line-height: var(--line-height);
    }

    .modal-day-events-content ul {
      list-style: none;
      padding: 0;
    }

    .modal-day-events-content ul li {
      padding: 10px;
      border-bottom: 1px solid var(--divisor);
      cursor: pointer;
      font-size: var(--font-sm);
      line-height: var(--line-height);
    }

    .modal-day-events-content ul li:hover {
      background-color: var(--cor-primaria-2);
      color: var(--txt-titulo);
    }

    .close-modal-day {
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: var(--font-xl);
      cursor: pointer;
      color: var(--cor-primaria-2);
    }

    .close-modal-day:hover {
      color: var(--cor-primaria-1);
    }

    /* Responsividade */
    @media (max-width: 768px) {
      #calendar {
        border-width: 1px;
      }

      /* Reorganiza a toolbar em duas linhas:
         - O segundo chunk (t√≠tulo) ficar√° sozinho na primeira linha.
         - O primeiro (navega√ß√£o) e o terceiro (views) ficar√£o juntos na segunda linha.
      */
      .fc-header-toolbar {
        flex-wrap: wrap;
      }

      /* For√ßa o t√≠tulo (supondo que seja o segundo chunk) a ocupar a primeira linha */
      .fc-header-toolbar>*:nth-child(2) {
        order: -1;
        flex-basis: 100%;
        text-align: center;
        margin-bottom: 10px;
        font-size: var(--font-xl);
      }

      /* Os demais elementos (primeiro e terceiro chunks) ficam na segunda linha */
      .fc-header-toolbar>*:nth-child(1),
      .fc-header-toolbar>*:nth-child(3) {
        order: 1;
        flex-basis: 50%;
        display: flex;
        align-items: center;
      }

      .fc-header-toolbar>*:nth-child(1) {
        justify-content: flex-start;
      }

      .fc-header-toolbar>*:nth-child(3) {
        justify-content: flex-end;
      }

      .fc-button {
        padding: 6px 10px;
        font-size: var(--font-md) !important;
      }
    }

    @media (max-width: 480px) {
      #calendar {
        height: calc(var(--vh, 1vh) * 100 - 7.5rem) !important;
      }

      .fc-toolbar-title {
        font-size: var(--font-lg) !important;
      }

      .fc-button {
        padding: 5px 8px !important;
        font-size: var(--font-sm) !important;
      }


    }
  </style>

  <!-- FullCalendar CSS via CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css">
</head>

<body class="body-template">

  <header class="header header-template">
    <div class="header-menu" onclick="toggleMenu(this)">
      <div class="bar1"></div>
      <div class="bar2"></div>
      <div class="bar3"></div>
    </div>
    <div class="header-notification" id="notification">
      <img src="./static/imagens/icones/notifica√ß√£o.svg" alt="√çcone de Notifica√ß√£o">
      <span id="notificationCounter" class="notification-counter">0</span>
    </div>
    <nav class="header-nav">
      <ul class="header-nav-template">
        <li class="home"><a href="index.html"><img src="./static/imagens/icones/home.svg" alt="√çcone Home">
            <p>home</p>
          </a></li>
        <li class="calendario indicador"><a href="calendario.html"><img src="./static/imagens/icones/calendario-select.svg" alt="√çcone Calend√°rio">
            <p>calendario</p>
          </a></li>
        <li class="tarefas"><a href="tarefas.html"><img src="./static/imagens/icones/tarefas.svg" alt="√çcone Tarefas">
            <p>Tarefas</p>
          </a></li>
        <li class="contatos"><a href="contatos.html"><img src="./static/imagens/icones/contatos.svg" alt="√çcone Contatos">
            <p>Contatos</p>
          </a></li>
        <li class="pleitos"><a href="pleitos.html"><img src="./static/imagens/icones/pleitos.svg" alt="√çcone Pleitos">
            <p>Pleitos</p>
          </a></li>
        <li class="arquivos"><a href="arquivos.html"><img src="./static/imagens/icones/arquivos.svg" alt="√çcone Arquivos">
            <p>Arquivos</p>
          </a></li>
        <li class="apps">
          <a href="#">
            <img src="./static/imagens/icones/apps.svg" alt="√çcone Apps">
            <p>Apps</p>
          </a>
        </li>
      </ul>
    </nav>
    <div class="header-search">
      <div>
        <form action="/evento/listcard" method="post" class="search-input-container">
          <input type="search" name="search" id="searchInput" class="search-input" placeholder="Pesquisar evento...">
          <button type="submit" class="search-button">
            <img class="search-icon" src="./static/imagens/icones/pesquisar.svg" alt="√çcone de Pesquisa">
          </button>
        </form>
      </div>
    </div>
  </header>

  <main class="main main-template-sem-sidenav">
    <section class="main-section fullcalendar-section">
      <div class="container-solo-template">
        <div class="container-solo-template-content">
          <!-- Calend√°rio -->
          <div id="calendar"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de Detalhes do Evento -->
  <div id="eventDetailModal" role="dialog" aria-modal="true" aria-labelledby="modalEventTitle">
    <div class="modal-detail-content">
      <span class="close-modal" tabindex="0">&times;</span>
      <h2 id="modalEventTitle">T√≠tulo do Evento</h2>
      <p><strong>Tipo:</strong> <span id="modalEventMarker"></span></p>
      <p><strong>Local:</strong> <span id="modalEventLocation"></span></p>
      <p><strong>Participantes:</strong> <span id="modalEventParticipants"></span></p>
      <p><strong>Dura√ß√£o:</strong> <span id="modalEventDuration"></span></p>
      <div id="modalEventMap"></div>
    </div>
  </div>
  <!-- Fim do Modal de Detalhes -->

  <!-- Modal de Lista de Eventos do Dia -->
  <div id="dayEventsModal" role="dialog" aria-modal="true" aria-labelledby="dayEventsModalTitle">
    <div class="modal-day-events-content">
      <span class="close-modal-day" tabindex="0">&times;</span>
      <h2 id="dayEventsModalTitle">Eventos do Dia</h2>
      <ul id="dayEventsList"></ul>
    </div>
  </div>
  <!-- Fim do Modal de Lista de Eventos do Dia -->

  <!-- Modal Bot√£o Flutuante -->
  <button class="floatingButton">+</button>
  <div class="modal-btn-floating-Overlay esconderModal">
    <div class="modal-btn-floating-content">
      <div class="modal-btn-floating-header">
        <h1>NOVO</h1>
      </div>
      <ul class="modal-btn-floating-body">
        <li><a href="evento_incluir.html">Evento</a></li>
        <li><a href="reuniao_incluir.html">Reuni√£o</a></li>
        <li><a href="tarefa_incluir.html">Tarefa</a></li>
        <li><a href="lembrete_incluir.html">Lembrete</a></li>
      </ul>
    </div>
  </div>

  <!-- Modal Menu -->
  <div class="modal" id="modalMenu">
    <div class="modal-content-template">
      <div class="modal-content-template-card-user">
        <div class="modal-content-template-card-user-img">
          <img src="./static/imagens/foto-do-usuario.png" alt="Foto do Usu√°rio" id="modalUserPhoto">
        </div>
        <p class="modal-content-template-card-user-candidato" id="candidato">Nome do candidato</p>
        <p class="modal-content-template-card-user-cargo-owner" id="cargoOwner">Cargo do candidato</p>
        <p class="modal-content-template-card-user-partido" id="partido">Partido do candidato</p>
        <div class="modal-content-template-card-user-secao">
          <div class="modal-content-template-card-user-username" id="username">Nome do Usu√°rio</div>
          <div class="modal-content-template-card-user-cargo" id="cargoUser">Cargo do Usu√°rio</div>
        </div>
        <a class="modal-content-template-card-user-gc" id="btnGerenciarConta" href="perfil.html"> Gerenciar conta</a>
      </div>
      <div class="modal-content-template-list-op">
        <ul class="modalMenu-list">
          <li class="alterar-tema">
            <button id="toggleTheme">
              <img id="themeIcon" src="./static/imagens/icones/sun.svg" alt="√çcone de Sol" />
              Alterar tema
            </button>
          </li>
          <li>
            <a href="home-organograma.html">
              <img src="./static/imagens/icones/organograma.svg" alt="√çcone Organograma">
              <span>Organograma</span>
            </a>
          </li>
          <li>
            <a href="dashboard-home.html">
              <img src="./static/imagens/icones/dashboard.svg" alt="√çcone Dashboard">
              <span>Dashboard</span>
            </a>
          </li>
          <li>
            <a href="home-financeiro.html">
              <img src="./static/imagens/icones/financeiro.svg" alt="√çcone Financeiro">
              <span>Financeiro</span>
            </a>
          </li>
          <li class="logout" onclick="logout()">
            <a id="btnLogout">
              <img src="./static/imagens/icones/sair.svg" alt="√çcone Sair">
              <span>Sair</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Modal Notifica√ß√µes -->
  <div class="modal-notificacoes" id="notificationModal">
    <div class="modal-content-notificacoes" id="modalContent">
      <span class="modal-notificacoes-btn-close" id="closeButton">&times;</span>
      <button id="markAllReadButton">Marcar todas como lidas</button>
      <ul id="notificationsContent" class="notifications-list">
        <!-- Notifica√ß√µes ser√£o inseridas dinamicamente -->
      </ul>
      <div id="noNotifications" class="no-notifications">N√£o h√° novas notifica√ß√µes</div>
    </div>
  </div>

  <!-- Modal para exibir mais aplicativos -->
  <div id="modalMaisApps" class="modal-mais-apps">
    <div class="modal-mais-apps-content">
      <div class="modal-mais-apps-close"></div>
      <ul class="modal-mais-apps-icones">
        <li>
          <a href="pleitos.html">
            <img src="./static/imagens/icones/pleitos.svg" alt="√çcone Pleitos" class="icone-app">
            <p>Pleitos</p>
          </a>
        </li>
        <li>
          <a href="arquivos.html">
            <img src="./static/imagens/icones/arquivos.svg" alt="√çcone Arquivos" class="icone-app">
            <p>Arquivos</p>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <script src="./static/js/config.js" defer></script>
  <script src="./static/js/RegisterSW.js" defer></script>
  <script src="./static/js/AlterarEsquemaDeCores.js" defer></script>
  <script src="./static/js/AtualizarAlturaPagina.js" defer></script>
  <script src="./static/js/ScrollAjustarItensContainerHeader.js" defer></script>
  <script src="./static/js/ModalBTNFloating.js" defer></script>
  <script src="./static/js/ModalMaisApps.js" defer></script>
  <script src="./static/js/ModalMenu.js" defer></script>
  <script src="./static/js/ModalNotificacoes.js" defer></script>
  <script src="./static/js/ManipularHistorico.js" defer></script>
  <script src="./static/js/OcultarExibirFiltro.js" defer></script>

  <!-- FullCalendar via CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/locales-all.global.min.js" defer></script>

  <!-- Script de integra√ß√£o do FullCalendar e modais -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var calendarEl = document.getElementById('calendar');
      var calendar = new FullCalendar.Calendar(calendarEl, {
        locale: 'pt-br',
        initialView: 'dayGridMonth',
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        buttonText: {
          today: 'Hoje',
          month: 'M√™s',
          week: 'Semana',
          day: 'Dia'
        },
        nowIndicator: true,
        scrollTime: new Date().getHours() + ':00:00',
        editable: true,
        selectable: true,
        eventClassNames: function (arg) {
          if (arg.event.extendedProps.markerType !== undefined) {
            return ['cor-marc' + arg.event.extendedProps.markerType];
          }
          return [];
        },
        events: [
          // Evento com hor√°rio definido
          {
            title: 'Caminhada',
            start: '2025-02-20T08:00:00',
            end: '2025-02-20T09:30:00',
            extendedProps: {
              marker: 'üìç',
              markerType: 10,
              location: 'Rua das Flores, 123',
              duration: '1h30',
              miniMap: 'https://via.placeholder.com/300x150?text=Mini+Mapa'
            }
          },
          // Evento com hor√°rio definido
          {
            title: 'Entevista',
            start: '2025-02-20T10:00:00',
            end: '2025-02-20T11:30:00',
            extendedProps: {
              marker: 'üìç',
              markerType: 3,
              location: 'Rua da Matriz, 33',
              participants: 'Alice, Bob, Carlos',
              duration: '1h30',
              miniMap: 'https://via.placeholder.com/300x150?text=Mini+Mapa'
            }
          },
          // Evento com hor√°rio definido
          {
            title: 'Evento de Lan√ßamento',
            start: '2025-02-22T14:00:00',
            end: '2025-02-22T16:00:00',
            extendedProps: {
              marker: 'üìå',
              markerType: 7,
              location: 'Av. Central, 456',
              participants: 'Diana, Eduardo, Fernanda',
              duration: '2h',
              miniMap: 'https://via.placeholder.com/300x150?text=Mini+Mapa'
            }
          },
          // Eventos do dia todo (all-day)
          {
            title: 'Evento Todo Dia - Reuni√£o Geral',
            start: '2025-02-20',
            allDay: true,
            extendedProps: {
              marker: 'üìÖ',
              markerType: 5,
              location: 'Audit√≥rio Principal',
              duration: 'Todo o dia',
              miniMap: 'https://via.placeholder.com/300x150?text=Mini+Mapa'
            }
          },
          {
            title: 'Evento Todo Dia - Plen√°ria',
            start: '2025-02-21',
            allDay: true,
            extendedProps: {
              marker: 'üìÖ',
              markerType: 6,
              location: 'Sala de Confer√™ncia B',
              duration: 'Todo o dia',
              miniMap: 'https://via.placeholder.com/300x150?text=Mini+Mapa'
            }
          }
        ],
        eventClick: function (info) {
          info.jsEvent.preventDefault();
          var event = info.event;
          document.getElementById("modalEventTitle").innerText = event.title;
          document.getElementById("modalEventMarker").innerText = event.extendedProps.marker || "";
          document.getElementById("modalEventLocation").innerText = event.extendedProps.location || "";
          document.getElementById("modalEventParticipants").innerText = event.extendedProps.participants || "";
          document.getElementById("modalEventDuration").innerText = event.extendedProps.duration || "";
          if (event.extendedProps.miniMap) {
            document.getElementById("modalEventMap").innerHTML = '<img src="' + event.extendedProps.miniMap + '" alt="Mini Mapa">';
          } else {
            document.getElementById("modalEventMap").innerHTML = "";
          }
          document.getElementById("eventDetailModal").style.display = "block";
        },
        dateClick: function (info) {
          if (info.view.type === 'dayGridMonth') {
            var dayEvents = calendar.getEvents().filter(function (event) {
              return event.start.toDateString() === info.date.toDateString();
            });
            var eventsListEl = document.getElementById('dayEventsList');
            eventsListEl.innerHTML = '';
            if (dayEvents.length > 0) {
              dayEvents.forEach(function (event) {
                var li = document.createElement('li');
                li.innerText = event.title;
                li.addEventListener('click', function (e) {
                  document.getElementById("modalEventTitle").innerText = event.title;
                  document.getElementById("modalEventMarker").innerText = event.extendedProps.marker || "";
                  document.getElementById("modalEventLocation").innerText = event.extendedProps.location || "";
                  document.getElementById("modalEventParticipants").innerText = event.extendedProps.participants || "";
                  document.getElementById("modalEventDuration").innerText = event.extendedProps.duration || "";
                  if (event.extendedProps.miniMap) {
                    document.getElementById("modalEventMap").innerHTML = '<img src="' + event.extendedProps.miniMap + '" alt="Mini Mapa">';
                  } else {
                    document.getElementById("modalEventMap").innerHTML = "";
                  }
                  document.getElementById("dayEventsModal").style.display = "none";
                  document.getElementById("eventDetailModal").style.display = "block";
                  e.stopPropagation();
                });
                eventsListEl.appendChild(li);
              });
            } else {
              var li = document.createElement('li');
              li.innerText = "Sem eventos";
              eventsListEl.appendChild(li);
            }
            var modalTitle = "Eventos em " + info.date.toLocaleDateString('pt-BR', { weekday: 'short', day: 'numeric' });
            document.querySelector('#dayEventsModal h2').innerText = modalTitle.replace(',', '.');
            document.getElementById("dayEventsModal").style.display = "block";
          }
        },
        views: {
          timeGridWeek: {
            // Cabe√ßalho: dia abreviado (linha 1) e n√∫mero (linha 2), ambos em pt-BR
            dayHeaderContent: function (arg) {
              let weekday = new Date(arg.date).toLocaleDateString('pt-BR', { weekday: 'short' });
              let day = new Date(arg.date).toLocaleDateString('pt-BR', { day: 'numeric' });
              return { html: weekday + '<br>' + day };
            }
          },
          timeGridDay: {
            // Cabe√ßalho: nome completo do dia em pt-BR
            dayHeaderContent: function (arg) {
              let fullDay = new Date(arg.date).toLocaleDateString('pt-BR', { weekday: 'long' });
              return { html: fullDay };
            }
          }
        }
      });
      calendar.render();

      // Fun√ß√£o para fechar os modais ao clicar fora ou pressionar ESC
      function closeModal(modalId) {
        document.getElementById(modalId).style.display = "none";
      }

      // Fechar modal de detalhes do evento ao clicar no "X"
      document.querySelector("#eventDetailModal .close-modal").addEventListener("click", function () {
        closeModal("eventDetailModal");
      });
      // Fechar modal de lista de eventos do dia ao clicar no "X"
      document.querySelector("#dayEventsModal .close-modal-day").addEventListener("click", function () {
        closeModal("dayEventsModal");
      });
      // Fechar modais ao clicar fora do conte√∫do
      window.addEventListener("click", function (event) {
        if (event.target === document.getElementById("eventDetailModal")) {
          closeModal("eventDetailModal");
        }
        if (event.target === document.getElementById("dayEventsModal")) {
          closeModal("dayEventsModal");
        }
      });
      // Fechar modais ao pressionar a tecla ESC
      document.addEventListener("keydown", function (event) {
        if (event.key === "Escape") {
          closeModal("eventDetailModal");
          closeModal("dayEventsModal");
        }
      });
    });
  </script>

</body>

</html>